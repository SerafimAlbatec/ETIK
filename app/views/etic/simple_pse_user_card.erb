<div id="loading"></div>
<div class="container con_home">
  <div class="row row_mat">
  	<div class="col-md-12">
      <h1>Καλαθι Αγορών</h1>
        <div class="table-responsive">
          <div class="pdf" id="pdf">
            <table class="table table_card table_grammata">

            <thead>
              <tr class="root">
                <th id="kartoula_head">Eικόνα</th>
                <th id="kartoula_head">extra</th> 
                <th id="kartoula_head">Ποσότητα</th> 
                <th id="kartoula_head">Τιμή</th> 
                <th></th>
              </tr>
            </thead>

            <tbody>
              <% if (!@items.nil?) %>
              <% @items.each do |item| %>
                <tr class="root">
                  <td><%= image_tag("/upload/#{item.canvas}.png",:height => "200px") %></td> <!---->
                  <!--extra-->
                  <td class="card_extra_left">
                    <b><%= t 'mpara.open_category' %></b>: <%= t 'kouf.'<<item.open_categorie_id %></br>
                    <b><%= t 'mpara.material' %></b>: <%= item.material_id %></br>
                    <b><%= t 'material.constructor' %></b>: <%= item.constructor_id %></br>
                    <b><%= t 'material.system' %></b>: <%= item.system_id %></br>
                    <b><%= t 'material.system' %></b>: <%= item.line_id %></br>
                    <b><%= t 'mpara.open_type' %></b>:  <%= item.open_type_id %><br>
                    <b><%= t 'mpara.leaf' %></b>: <%= Leaf.where(:id => item.leaf_id).first.name %></br>
                    <b>Υψος</b>: <%= item.height %>mm</br>
                    <b>Πλάτος</b>: <%= item.width %>mm</br>
                    <% if ( !item.xwrisma1.nil? ) %>
                    <b>Χώρισμα αριστερά</b>: <%= item.xwrisma1 %>mm,<br> <b>Χώρισμα δεξιά</b>: <%= item.xwrisma2 %>mm<br>
                    <% end %>
                    <% if ( !item.xwrisma3_1.nil? ) %>
                    <b>Χώρισμα αριστερά</b>: <%= item.xwrisma3_1 %>mm<br>
                    <b>Χώρισμα μέση</b>: <%= item.xwrisma3_2 %>mm<br>
                    <b>Χώρισμα δεξιά</b>: <%= item.xwrisma3_3 %>mm<br>
                    <% end %>
                    <% if ( !item.xwrisma_y_1.nil? ) %>
                    <b>Χώρισμα πάνω</b>: <%= item.xwrisma_y_1 %>mm<br>
                    <b>Χώρισμα κάτω</b>: <%= item.xwrisma_y_2 %>mm<br>
                    <% end %>
                    <b>Χρώμα</b>:  <%= item.main_color_id %><br>
                    <% if ( !item.right_color_id.nil? ) %>
                    <b>Χρώμα δεξια</b>: <%= item.right_color_id %><br>
                    <b>Χρώμα αριστέρα</b>: <%= item.left_color_id %><br>
                    <b>Χρώμα πάνω</b>: <%= item.up_color_id %><br>
                    <b>Χρώμα κάτω</b>: <%= item.down_color_id %><br>
                    <% end %>
                    <% if ( !item.leaf_color_id.nil? ) %>
                      <b>Χρώμα φύλου</b>: <%= item.leaf_color_id %><br>
                    <% end %>
                    <% if ( item.lastixo == 1 ) %>
                      <b>Μαύρο λάστιχο</b><br>
                    <% end %>
                    <u><%= t 'material_pinakas.arxiki_timi' %>:  <color style="color:#ff0000"><%= number_with_precision(item.price_new, :precision => 2) %> €</color></u></br></br>
                    <div class="on_off">
                    <a class="show_more">Show more...</a>
                    <div class="extra_show_hide">
                    <% if ( !item.tzamia.nil? ) %>
                      <b>Τζάμι</b>: <%= item.tzamia %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.price_tzamiou %></color> €)<br>
                    <% end %>
                    <% if ( !item.rolo.nil? ) %>
                      <b>Ρολό</b>: <%= item.rolo %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.price_rolou %></color> €)<br>
                      Χρώμα ρολού: <%= item.color_rolou %><br>
                    <% end %>
                    <% if ( !item.odoigos.nil? ) %>
                      <b>Οδοιγός</b>: <%= item.odoigos %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.price_odoigou %></color> €)<br>
                      Χρώμα οδοιγού: <%= item.color_odoigou %><br>
                    <% end %>
                    <% if ( !item.persida.nil? ) %>
                      <b>Περσίδα</b>: <%= item.persida %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.price_persidas %></color> €)<br>
                      Χρώμα περσίδας: <%= item.color_persidas %><br>
                      <hr class="hr_card">
                    <% end %>
                    <% if ( !item.profil_deksia_1.nil? ) %>
                      <b>Προφιλ δεξιά</b>: <%= item.profil_deksia_1 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_deksia_1 %></color> €)<br>
                      Ποσότητα προφιλ δεξια: <%= item.profil_deksia_arithmos_1 %><br>
                    <% end %>
                    <% if ( !item.profil_deksia_2.nil? ) %>
                      <b>Προφιλ δεξιά</b>: <%= item.profil_deksia_2 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_deksia_2 %></color> €)<br>
                      Ποσότητα προφιλ δεξια: <%= item.profil_deksia_arithmos_2 %><br>
                    <% end %>
                    <% if ( !item.profil_deksia_3.nil? ) %>
                      <b>Προφιλ δεξιά</b>: <%= item.profil_deksia_3 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_deksia_profil_3 %></color> €)<br>
                      Ποσότητα προφιλ δεξια: <%= item.profil_deksia_arithmos_3 %><br>
                    <% end %>
                    <% if ( !item.profil_deksia_1.nil? || !item.profil_deksia_2.nil? || !item.profil_deksia_3.nil? ) %>
                      <b>Χρώμα προφιλ δεξια</b>: <%= item.color_profil_d %><br>
                      <hr class="hr_card">
                    <% end %>
                    <% if ( !item.profil_aristera_1.nil? ) %>
                      <b>Προφιλ αριστερά</b>: <%= item.profil_aristera_1 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_aristera_1 %></color> €)<br>
                      Ποσότητα προφιλ αριστερά: <%= item.profil_aristera_arithmos_1 %><br>
                    <% end %>
                    <% if ( !item.profil_aristera_2.nil? ) %>
                      <b>Προφιλ αριστερά</b>: <%= item.profil_aristera_2 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_aristera_2 %></color> €)<br>
                      Ποσότητα προφιλ αριστερά: <%= item.profil_aristera_arithmos_2 %><br>
                    <% end %>
                    <% if ( !item.profil_aristera_3.nil? ) %>
                      <b>Προφιλ αριστερά</b>: <%= item.profil_aristera_3 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_aristera_3 %></color> €)<br>
                      Ποσότητα προφιλ αριστερά: <%= item.profil_aristera_arithmos_3 %><br>
                    <% end %>
                    <% if ( !item.profil_aristera_1.nil? || !item.profil_aristera_2.nil? || !item.profil_aristera_3.nil? ) %>
                      <b>Χρώμα προφιλ αριστερά</b>: <%= item.color_profil_a %><br>
                      <hr class="hr_card">
                    <% end %>
                    <% if ( !item.profil_panw_1.nil? ) %>
                      <b>Προφιλ πάνω</b>: <%= item.profil_panw_1 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_panw_1 %></color> €)<br>
                      Ποσότητα προφιλ πάνω: <%= item.profil_panw_arithmos_1 %><br>
                    <% end %>
                    <% if ( !item.profil_panw_2.nil? ) %>
                      <b>Προφιλ πάνω</b>: <%= item.profil_panw_2 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_panw_2 %></color> €)<br>
                      Ποσότητα προφιλ πάνω: <%= item.profil_panw_arithmos_2 %><br>
                    <% end %>
                    <% if ( !item.profil_panw_3.nil? ) %>
                      <b>Προφιλ πάνω</b>: <%= item.profil_panw_3 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_panw_3 %></color> €)<br>
                      Ποσότητα προφιλ πάνω: <%= item.profil_panw_arithmos_3 %><br>
                    <% end %>
                    <% if ( !item.profil_panw_1.nil? || !item.profil_panw_2.nil? || !item.profil_panw_3.nil? ) %>
                      <b>Χρώμα προφιλ πάνω</b>: <%= item.color_profil_p %><br>
                      <hr class="hr_card">
                    <% end %>
                    <% if ( !item.profil_katw_1.nil? ) %>
                      <b>Προφιλ κάτω</b>: <%= item.profil_katw_1 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_katw_1 %></color> €)<br>
                      Ποσότητα προφιλ κάτω: <%= item.profil_katw_arithmos_1 %><br>
                    <% end %>
                    <% if ( !item.profil_katw_2.nil? ) %>
                      <b>Προφιλ κάτω</b>: <%= item.profil_katw_2 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_katw_2 %></color> €)<br>
                      Ποσότητα προφιλ κάτω: <%= item.profil_katw_arithmos_2 %><br>
                    <% end %>
                    <% if ( !item.profil_katw_3.nil? ) %>
                      <b>Προφιλ κάτω</b>: <%= item.profil_katw_3 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_profil_katw_3 %></color> €)<br>
                      Ποσότητα προφιλ κάτω: <%= item.profil_katw_arithmos_3 %><br>
                    <% end %>
                    <% if ( !item.profil_katw_1.nil? || !item.profil_katw_2.nil? || !item.profil_katw_3.nil? ) %>
                      <b>Χρώμα προφιλ κάτω</b>: <%= item.color_profil_k %><br>
                      <hr class="hr_card">
                    <% end %>
                    <% if ( !item.typos_katw_1.nil? ) %>
                      <b>Τύπος κάτω</b>: <%= item.typos_katw_1 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_typos_katw_1 %></color> €)<br>
                      Ποσότητα τύπου κάτω: <%= item.typos_katw_arithmos_1 %><br>
                    <% end %>
                    <% if ( !item.typos_katw_2.nil? ) %>
                      <b>Τύπος κάτω</b>: <%= item.typos_katw_2 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_typos_katw_2 %></color> €)<br>
                      Ποσότητα τύπου κάτω: <%= item.typos_katw_arithmos_2 %><br>
                    <% end %>
                    <% if ( !item.typos_katw_3.nil? ) %>
                      <b>Τύπος κάτω</b>: <%= item.typos_katw_3 %> (<color style="color:#ff0000">+</color><%= t 'mpara.price' %>: <color style="color:#ff0000"><%= item.timi_typos_katw_3 %></color> €)<br>
                      Ποσότητα τύπου κάτω: <%= item.typos_katw_arithmos_3 %><br>
                    <% end %>
                    <% if ( !item.typos_katw_1.nil? || !item.typos_katw_2.nil? || !item.typos_katw_3.nil? ) %>
                      <b>Χρώμα τύπου κάτω</b>: <%= item.color_profil_k %><br>
                    <% end %>
                    
                    </div>
                    <a class="show_less">Show less...</a>
                    </div>
                  </td>
                  <td><input class="input" type="text" name="lname" size="5" placeholder="<%= item.posotoita %>" id="<%= item.id %>"></td>
                  <td id="price" class="price"><%= number_with_precision(item.price_sum, :precision => 2) %> €</td>
                  <% if @done != 1 %>
                  <td><%= link_to 'Destroy', etic_destroy_path(:id => item.id), method: :delete, data: { confirm: 'Are you sure?' } , class: 'btn btn-danger btn-xs'%><br>
                  <% if @admin != "1" %>
                  <%= link_to " Επανάληψη", etic_extra_path(:open_categorie_name => item.open_categorie_id, :material_name => item.material_id, :constructor_name => item.constructor_id, :system_name => item.system_id, :line_name => item.line_id, :leaf_name => Leaf.where(:name => item.leaf_id).first.name , :open_type_name => item.open_type_id, :color_name => item.main_color_id, :mesa_eksw => item.in_out, :xwrisma1 => item.xwrisma1, :xwrisma2 => item.xwrisma2, :xwrisma3_1 => item.xwrisma3_1, :xwrisma3_2 => item.xwrisma3_2, :xwrisma3_3 => item.xwrisma3_3, :xwrisma_y_1 => item.xwrisma_y_1, :xwrisma_y_2 => item.xwrisma_y_2, :color_deksia => item.right_color_id, :color_aristera => item.left_color_id, :color_panw => item.up_color_id, :color_katw => item.down_color_id, :color_fulou => item.leaf_color_id, :lastixo => item.lastixo, :width => item.width, :height => item.height, :order => item.id, :paraggelia_id => item.paraggelia_id, :dealer_id => @dealer_id), class: "btn btn-warning"%>
                  <% else %>
                  <% end %>
                </td>
                <% end %><!--End tou if gia user done-->
                </tr>
              <% end %>
              <% end %>
            </tbody>
          </table>
      
            <label id="sunolo"><b>Συνολο παραγγελίας:</b> </label><label id="timi_sunolou"> <%= number_with_precision(@sunolo, :precision => 2) %> €</label></br>
       </div><!--end canvas gia pdf-->
     </div>
            <% if (@number > 0) %>
            <% if @done != 1 %>
            <button type="button" class="btn btn-default update">Update</button>
            
            <%= link_to "Ολοκλήρωση παραγγελίας" ,etic_oloklirwsi_simple_user_pses_path(:id => @paraggelia_id) , data: { confirm: 'Are you sure? If you press OK, this order will be send for preparation!!' }, class: "btn btn-primary oloklirwsi"%>

            <%= link_to " Διαγραφή παραγγελίας", etic_diagrafi_simple_user_path(:id => @paraggelia_id), class: "btn btn-primary diagrafi"%>
            <% end %><!--end done 1-->
            <%= link_to "Show PDF" ,etic_pdf_simple_user_path(:id => @paraggelia_id,:pse => 1,:format => 'pdf') , class: "btn btn-primary pdf", :target => "_blank"%>
            <%= link_to "Download_xls", etic_export_simple_user_path(:id => @user_id,:pse => 1,:format => "xls") ,class: "btn btn-primary", :target => "_blank" %>
            <%= link_to "Download_csv", etic_export_simple_user_path(:id => @user_id,:pse => 1,:format => "csv") ,class: "btn btn-primary", :target => "_blank" %>
            <%= link_to "Download_xml", etic_export_simple_user_path(:id => @user,:pse => 1,:format => "xml") ,class: "btn btn-primary", :target => "_blank" %>
            <% end %>
  	</div>
  </div>
</div>

<script>


$(document).ready(function(){

  $(".extra_show_hide").hide();
  $(".show_less").hide();

  $(".show_more").click(function(){
    $(this).next().toggle();
    $(this).hide();
    $(this).next().next().show();
  });

  $(".show_less").click(function(){
    $(this).prev().toggle();
    $(this).prev().prev().show();
    $(this).hide();
  });

  $(".update").click(function(){
    $("input").each(function(){ //Για καθε input κανω τo update
      if ( $(this).val().length ) { //ελεγχω αν εχει αλλαξει το value και δεν υπαρχει μονο placeholder
        //alert($(this).attr('id'));
        $.ajax({
            type:'GET',
            url:'/etic/update_admin',
            dataType: "json",
            data: { amount: $(this).val(), id: $(this).attr('id')},
            success: function(data) { 
              },
            error: function(data) { 
              }
          }); //ajax end
          } //end if
     }); //each end
    location.reload();
  });//update end



}); //ready end



</script>